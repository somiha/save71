<%- include('../header-one'),{menuId:menuId}; -%>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css">
<link rel="stylesheet" type="text/css" href="./css/daterangepicker.css" />

<style>
    #phone {
        width: 1300px;
        /* Ensures full width */
    }

    .mb-3 {
        margin-bottom: 1rem;
    }

    label {
        display: block;
        /* Ensure the label takes up the full width */
        margin-bottom: 0.5rem;
        /* Add space between the label and input */
    }

    /* General styling for larger screens */
    .mobile-number {
        width: 170%;
        /* Takes full width within its container */
        max-width: 1300px;
        /* Limits the width to 1300px for large screens */
        box-sizing: border-box;
        /* Ensures padding is included in the width */
    }

    /* Responsive styling for smaller screens */
    /* For extra large devices (1200px and above) */
    @media (max-width: 1200px) {
        .mobile-number {
            max-width: 1000px;
        }
    }

    /* For large devices (992px and below) */
    @media (max-width: 992px) {
        .mobile-number {
            max-width: 800px;
        }
    }

    /* For medium devices (768px and below) */
    @media (max-width: 768px) {
        .mobile-number {
            max-width: 600px;
        }
    }

    /* For small devices (576px and below) */
    @media (max-width: 576px) {
        .mobile-number {
            max-width: 100%;
            /* Ensures full width on small devices */
        }
    }
</style>

<div class="w-100 bg-light">
    <%- include('../dashboard-topbar'),{menuId:menuId}; -%>
    <style>
        .highlighted {
            background-color: yellow;
            /* Change the background color to highlight */
            border-radius: 5px;
            /* Add rounded corners to the border */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            /* Add a subtle shadow for a material effect */
            transition: 1s ease-in-out;
            /* Longer transition duration for a smoother effect */
        }
    </style>

    <!-- tab section -->
    <div class=" my-5 px-2 mt-5">
        <nav class="mb-4 w-100 px-lg-5 py-5 py-lg-0 overflow-x-auto">

            <div class="row">
                <div class="col-sm-3 text-start">
                </div>
                <div class="col-sm-6 text-start">
                    <!-- Empty space -->
                </div>

            </div>



        </nav>
        <div class="tab-content w-100 px-5">


            <section class="my-2">
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-wrap" style="overflow-x: auto;">
                            <form action="/add-employee" method="POST">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" class="form-control" id="name" name="name" required>
                                </div>

                                <div class="mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" required>
                                </div>



                                <div class="mb-3">
                                    <label for="password" class="form-label">Password</label>
                                    <!-- <input type="password" class="form-control" id="password" name="password" required> -->
                                    <div class="position-relative">
                                        <input type="password" id="password" name="password" class="form-control"
                                            required />

                                        <p class="password-show-btn"
                                            style="position:absolute; right:2%; top:50%; transform: translateY(-50%); cursor:pointer; z-index: 1;">
                                            <i class="bi bi-eye-fill"></i>
                                        </p>

                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="confirmPassword" class="form-label">Confirm Password</label>
                                    <div class="position-relative">
                                        <input type="password" class="form-control" id="confirmPassword"
                                            name="confirmPassword" required>

                                        <p class="password-show-btn"
                                            style="position:absolute; right:2%; top:50%; transform: translateY(-50%); cursor:pointer; z-index: 1;">
                                            <i class="bi bi-eye-fill"></i>
                                        </p>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="designation" class="form-label">Designation</label>
                                    <input type="text" class="form-control" id="designation" name="designation"
                                        required>
                                </div>

                                <div class="mb-3">
                                    <label for="mobile_number" class="form-label">Mobile Number</label>
                                    <input type="tel" class="form-control py-2 w-full" id="phone" name="mobile_number"
                                        required>
                                    <div id="error-msg" style="color: red; margin-top: 5px;"></div>
                                    <div id="valid-msg" style="color: green; margin-top: 5px;"></div>
                                </div>

                                <div class="mb-3">
                                    <label for="address" class="form-label">Address</label>
                                    <input type="text" class="form-control" id="address" name="address" required>
                                </div>

                                <div class="mb-3">
                                    <h5>Permissions</h5>

                                    <!-- Example of grouped permissions -->
                                    <% const groupedPermissions = {}; %>
                                    <% permissions.forEach(permission => { 
                                            const group = permission.permission_group;
                                            if (!groupedPermissions[group]) {
                                                groupedPermissions[group] = [];
                                            }
                                            groupedPermissions[group].push(permission);
                                        }); %>

                                    <% for (const group in groupedPermissions) { %>
                                    <fieldset>
                                        <legend><%= group %></legend>

                                        <!-- Loop through permissions in each group -->
                                        <% groupedPermissions[group].forEach(permission => { %>
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input"
                                                id="permission_<%= permission.permission_id %>" name="permissions[]"
                                                value="<%= permission.permission_id %>">
                                            <label class="form-check-label"
                                                for="permission_<%= permission.permission_id %>">
                                                <%= permission.permission_name %>
                                            </label>
                                        </div>
                                        <% }); %>
                                    </fieldset>
                                    <% } %>
                                </div>




                                <button type="submit" class="btn btn-primary">Add Employee</button>
                        </div>
                    </div>
                </div>

            </section>



        </div>
    </div>


</div>


<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.3/purify.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

<script type="text/javascript">
    $(function () {

        var start = moment().subtract(29, 'days');
        var end = moment();

        function cb(start, end) {
            $('#reportrange span').html(start.format('MMM D, YYYY') + ' - ' + end.format('MMM D, YYYY'));

            // If no range is selected, show all orders
            if (!start || !end) {
                $('#rejected-order, #confirmed-order, #accepted-order, #new-order').show();
                return;
            }

            // Iterate through each parent div and check if the order date is within the selected range
            $('#rejected-order, #confirmed-order, #accepted-order, #new-order').each(function () {
                $(this).find('.order').each(function () {
                    var orderDate = moment($(this).find('#order_date').text().replace('Placed Date:', ''), 'YYYY-MM-DD');
                    if (orderDate.isBetween(start, end, null, '[]')) {
                        // Order date is within the selected range, show the parent div
                        $(this).show();
                    } else {
                        // Order date is outside the selected range, hide the parent div
                        $(this).hide();
                    }
                })
            });
        }

        $('#reportrange').daterangepicker({
            startDate: start,
            endDate: end,
            ranges: {
                'Today': [moment(), moment()],
                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                'This Month': [moment().startOf('month'), moment().endOf('month')],
                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, cb);

        cb(); // Call initially to show all orders

    });
</script>
<script>
    const passShowBtn = document.querySelectorAll('.password-show-btn');
    passShowBtn.forEach(psb => {
        psb.addEventListener('click', e => {
            const passField = psb.parentElement.children[0];
            if (passField.type == 'password') passField.type = 'text';
            else passField.type = 'password'
        })
    })
</script>

<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>

<script>
    window.intlTelInputGlobals.loadUtils("./js/utils.js"); // for isValidNumber function

    function getDecCCo(url) {
        return fetch(url)
            .then(response => response.json())
            .then(data => {
                return {
                    countryCode: data.countryCode
                };
            })
            .catch(error => {
                console.error('Error:', error);
                throw error;
            });
    }

    async function initializeTelInput() {
        try {
            const apiUrl = `/__gCCo`;
            const {
                countryCode
            } = await getDecCCo(apiUrl);
            const input = document.querySelector("#phone");


            const telInput = intlTelInput(input, {
                initialCountry: countryCode || "auto",
                autoInsertDialCode: true,
                separateDialCode: false,
            });


            const errorDisplay = document.querySelector("#error-msg");
            const validDisplay = document.querySelector("#valid-msg");
            const submitButt = document.querySelector("#loginForm");

            // Function to update the placeholder based on the selected country
            function updatePlaceholder() {
                const selectedCountryData = telInput.getSelectedCountryData();
                const newInputValue = "+" + selectedCountryData.dialCode;
                input.value = newInputValue;
            }

            // Function to check if the entered phone number is valid
            function checkValidNumber() {
                if (input.value.trim()) {
                    if (telInput.isValidNumber()) {
                        validDisplay.textContent = "Valid phone number";
                        errorDisplay.textContent = "";
                        submitButt.disabled = false;
                    } else {
                        validDisplay.textContent = "";
                        errorDisplay.textContent = "Invalid phone number";
                        submitButt.disabled = true;
                    }
                }
            }

            updatePlaceholder();
            input.addEventListener("countrychange", updatePlaceholder);
            input.addEventListener("keyup", checkValidNumber); // Check validity on keyup event
        } catch (error) {
            console.error('Error:', error);
        }
    }

    initializeTelInput();
</script>

<!-- Filter Script -->
<%- include('../footer-one'); -%>